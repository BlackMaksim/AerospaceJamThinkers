<!DOCTYPE html>
<html>
<head>
    <title>Aerospace Jam Base Station</title>
    <script src="{{ url_for('static', filename='js/socket.io.js') }}"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
        .sensor-block { 
            background: #f9f9f9; 
            border: 1px solid #ddd; 
            padding: 15px; 
            margin-bottom: 15px; 
            border-radius: 8px;
        }
        .controls {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px;
            background: #eef;
            border-radius: 8px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            margin: 0 10px;
            cursor: pointer;
        }
        .val { font-weight: bold; color: #0066cc; }
    </style>
</head>
<body>
    <h1>Aerospace Jam Base Station</h1>
    
    <div class="controls">
        <h3>Motor Control</h3>
        <button id="btnForward">Forward</button>
        <button id="btnStop" style="background-color: #ffcccc;">STOP</button>
        <button id="btnBackward">Backward</button>
    </div>

    <div class="sensor-block">
        <h3>Barometer (BMP180)</h3>
        <p>Pressure: <span id="barometricPressure" class="val">Loading...</span> hPa</p>
    </div>

    <div class="sensor-block">
        <h3>LiDAR (TF-Luna)</h3>
        <p>Distance: <span id="lidarDistance" class="val">Loading...</span> cm</p>
    </div>

    <div class="sensor-block">
        <h3>IMU (MPU-6050)</h3>
        <p>Accel: X:<span id="accelX" class="val">0</span> Y:<span id="accelY" class="val">0</span> Z:<span id="accelZ" class="val">0</span></p>
        <p>Gyro: X:<span id="gyroX" class="val">0</span> Y:<span id="gyroY" class="val">0</span> Z:<span id="gyroZ" class="val">0</span></p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var socket = io.connect('http://' + document.domain + ':' + location.port);

            // Update Sensor Data
            socket.on('update_data', function(msg) {
                // BMP180
                if(msg.barometricPressure) document.getElementById('barometricPressure').textContent = msg.barometricPressure;

                // TF-Luna
                if(msg.lidarDistance) document.getElementById('lidarDistance').textContent = msg.lidarDistance;

                // MPU-6050
                if(msg.accelX !== undefined) {
                    document.getElementById('accelX').textContent = msg.accelX;
                    document.getElementById('accelY').textContent = msg.accelY;
                    document.getElementById('accelZ').textContent = msg.accelZ;
                    document.getElementById('gyroX').textContent = msg.gyroX;
                    document.getElementById('gyroY').textContent = msg.gyroY;
                    document.getElementById('gyroZ').textContent = msg.gyroZ;
                }
            });

            // Motor Control Logic
            function sendMotorCommand(action) {
                console.log('Sending motor command:', action);
                socket.emit('control_motor', { action: action });
            }

            document.getElementById('btnForward').addEventListener('click', function() {
                sendMotorCommand('forward');
            });
            
            document.getElementById('btnBackward').addEventListener('click', function() {
                sendMotorCommand('backward');
            });
            
            document.getElementById('btnStop').addEventListener('click', function() {
                sendMotorCommand('stop');
            });
        });
    </script>
</body>
</html>